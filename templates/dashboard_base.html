{% extends "base.html" %}
{% block body %}

<!-- Sidebar: fixed on lg+, hidden on small -->
<div class="sidebar d-none d-lg-block position-fixed top-0 start-0 vh-100 bg-white border-end pt-5">
  <div class="px-3">
    <div class="mb-4">
      <a class="text-decoration-none fw-bold" href="{% url 'dashboard' %}">ğŸ  Dashboard</a>
    </div>

    <ul class="nav nav-pills flex-column gap-1">
      <a class="nav-link {% if active == 'tasks' %}active{% endif %}" href="{% url 'task_list' %}">ğŸ—‚ï¸ Tasks</a>
      <a class="nav-link {% if active == 'ann' %}active{% endif %}" href="{% url 'announcement_list' %}">ğŸ“¢ Announcements</a>
      <a class="nav-link {% if active == 'res' %}active{% endif %}" href="{% url 'booking_home' %}">ğŸš—/ğŸ¢ Reservations</a>
      <a class="nav-link {% if category == 'cars' %}active{% endif %}" href="{% url 'booking_vehicles' %}">Vehicles</a>
      <a class="nav-link {% if category == 'rooms' %}active{% endif %}" href="{% url 'booking_rooms' %}">Rooms</a>
    </ul>

    <hr>
    <div class="d-grid gap-2">
      <a class="btn btn-outline-secondary btn-sm" href="#">ğŸ‘¤ Profile</a>
      <form method="post" action="{% url 'core:logout' %}">
        {% csrf_token %}
        <button class="btn btn-outline-danger btn-sm" type="submit">ğŸšª Logout</button>
      </form>
    </div>

    {% if user.role == "MANAGER" or user.role == "GM" %}
      <hr>
      <div class="small text-uppercase text-muted">Manager Tools</div>
      <ul class="nav flex-column gap-1 mt-2">
        <li class="nav-item"><a class="nav-link" href="#">+ Yeni Duyuru</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Åikayet/Ã–neri Kutusu</a></li>
      </ul>
    {% endif %}
  </div>
</div>

<!-- Main content: gains left margin on lg via base.css -->
<div class="content">
  <!-- Top navbar -->
  <nav class="navbar navbar-expand navbar-light bg-white border-bottom mb-3">
    <div class="container-fluid">
      <span class="navbar-text me-auto">
        Welcome, <strong>{{ user.get_full_name|default:user.username }}</strong> 
        <span class="badge bg-secondary">{{ user.get_role_display }}</span>
      </span>

      <ul class="navbar-nav">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="profileDropdown"
             role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <span class="bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center"
                  style="width: 32px; height: 32px; font-size: 14px;">
              {{ user.first_name.0|default:user.username.0|upper }}
            </span>
          </a>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
            <li><a class="dropdown-item" href="#">ğŸ‘¤ Profile</a></li>
            <li><a class="dropdown-item" href="#">âš™ï¸ Settings</a></li>
            <li><hr class="dropdown-divider"></li>
            <li>
              <form method="post" action="{% url 'core:logout' %}" class="px-3">
                {% csrf_token %}
                <button type="submit" class="dropdown-item text-danger">ğŸšª Logout</button>
              </form>
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </nav>

  <div class="container-fluid py-4">
    <!-- Messages inside content area -->
    {% if messages %}
      {% for message in messages %}
        {% with level=message.tags %}
          <div class="alert alert-{% if level == 'error' %}danger{% else %}{{ level }}{% endif %} alert-dismissible fade show auto-dismiss mb-3"
               role="alert" data-timeout="4000">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endwith %}
      {% endfor %}
    {% endif %}

    {% block content %}{% endblock %}
  </div>
</div>
{% endblock %}
